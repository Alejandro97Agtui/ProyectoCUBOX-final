<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="ISO-8859-1">
	<title>UsuariosA CUBOX</title>

	<!-- librería Sweetalert -->
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

	<!-- Bootstrap CSS -->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

	<!-- FontAwesome para íconos -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

	<!-- DataTables CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">

	<!-- DataTables Buttons CSS -->
	<link rel="stylesheet" href="https://cdn.datatables.net/buttons/2.4.1/css/buttons.dataTables.min.css">
</head>

<body>

	<div id="layoutSidenav_content">
		<main>
			<div class="container-fluid px-4 mt-4">
				<h2 class="my-4">Usuarios Admin</h2>

				<!-- Botón para registrar usuario -->
				<a th:href="@{/usuarios/registrar}" class="btn btn-success mb-4">
					<i class="fas fa-user-plus"></i> Registrar Usuario
				</a>
				
				<div style="display: inline;">
					<!-- Botón para regresar a panel-->
					<a th:href="@{/panel}" class="btn btn-secondary mb-4">
						<i class="fa-solid fa-rotate-left"></i> Regresar
					</a>
				</div>

				<!-- Tabla de usuarios -->
				<div class="table-responsive">
					<table id="datatablesSimple" class="table table-striped table-hover table-bordered align-middle">
						<thead class="table-dark">
							<tr>
								<th>ID</th>
								<th>Nombre</th>
								<th>Apellidos</th>
								<th>Imagen</th>
								<th>Email</th>
								<th>Celular</th>
								<th>DNI</th>
								<th>Rol</th>
								<th>F. Registro</th>
								<th>Acciones</th>
							</tr>
						</thead>
						<tbody>
							<tr th:each="u : ${lstUsuariosAdmin}">
								<td th:text="${u.idusuario}">ID</td>
								<td th:text="${u.nombre}">Nombre</td>
								<td th:text="${u.apellidos}">Apellidos</td>
								<td>
<!--									<img th:if="${#strings.isNotEmpty(u.imagen)}" th:src="@{/MostrarImagen(id=${u.idusuario})}"-->
<!--										alt="Imagen Usuario" width="120" height="120" />-->
								<!-- <img th:if="${p.imagen != null and p.imagen != ''}"
                                         th:src="@{/MostrarImagen(id=${p.idusuario})}"
                                         alt="Imagen Usuario" width="120" height="120" /> -->
									<img th:src="@{/usuarios/imagenUsuario(idusuario=${u.idusuario})}"
										alt="Imagen Usuario" width="120" height="120" />
								</td>
								<td th:text="${u.email}">Email</td>
								<td th:text="${u.celular}">Celular</td>
								<td th:text="${u.dni}">DNI</td>
								<td th:text="${u.rol}">Rol</td>
								<td th:text="${u.fechaRegistro}">F. Registro</td>
<!--								<td th:text="${p.fechaRegistro != null ? #temporals.format(p.fechaRegistro,'dd/MM/yyyy') : ''}">
                                   	F. Registro
		                        </td>  -->
								<td class="text-center">
									<a th:href="@{/editarUsu(id=${u.idusuario})}" class="btn btn-sm btn-outline-primary me-1"
										title="Editar">
										<i class="fas fa-pencil-alt"></i>
									</a>

									<a th:href="@{/UsuarioCrud(accion='eli',id=${u.idusuario})}"
										class="btn btn-sm btn-outline-danger" title="Eliminar"
										onclick="return confirm('¿Confirmas eliminar este usuario?');">
										<i class="fas fa-trash-alt"></i>
									</a>
								</td>
							</tr>
						</tbody>
					</table>
				</div>
			</div>
		</main>
	</div>

	<!-- Bootstrap JS -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

	<!-- jQuery -->
	<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

	<!-- DataTables JS -->
	<script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js"></script>
	<script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js"></script>

	<!-- DataTables Buttons JS -->
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/dataTables.buttons.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.html5.min.js"></script>
	<script src="https://cdn.datatables.net/buttons/2.4.1/js/buttons.print.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/pdfmake.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.2.7/vfs_fonts.js"></script>

	<!-- Inicialización de DataTables con botones -->
	<script>
		$(document).ready(function () {
			$('#datatablesSimple').DataTable({
				language: {
					url: '//cdn.datatables.net/plug-ins/1.13.4/i18n/es-ES.json'
				},
				dom: 'Bfrtip', // activa la barra de botones
				buttons: ['copy', 'excel', 'pdf', 'print']
			});
		});
	</script>

</body>

</html>